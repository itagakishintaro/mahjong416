{"version":3,"file":"mahjong-title.js","sourceRoot":"","sources":["src/mahjong-title.ts"],"names":[],"mappings":"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","sourcesContent":["import {LitElement, html, css} from 'lit';\nimport {customElement, state} from 'lit/decorators.js';\nimport {db} from './firestore';\nimport {collection, addDoc, getDocs} from 'firebase/firestore/lite';\nimport '@patternfly/elements/pf-accordion/pf-accordion.js';\n\ninterface MahjongTitle {\n  id: number;\n  year: number;\n  name: string;\n  winner: string;\n  displayOrder: number;\n}\n\n@customElement('mahjong-title')\nexport class MahjongTitleList extends LitElement {\n  static override styles = [\n    css`\n      .title-form {\n        margin-bottom: 20px;\n        padding: 15px;\n        border: 1px solid #ccc;\n        border-radius: 5px;\n      }\n      .title-list {\n        display: flex;\n        flex-direction: column;\n        gap: 20px;\n      }\n      .year-group {\n        border-top: 2px solid #666;\n        padding-top: 15px;\n      }\n      .year-header {\n        font-size: 1.2em;\n        margin-bottom: 10px;\n        color: #333;\n      }\n      .title-items {\n        display: grid;\n        gap: 10px;\n      }\n      .title-item {\n        padding: 10px;\n        border: 1px solid #eee;\n        border-radius: 4px;\n        background: #fff;\n      }\n      .title-item h3 {\n        margin: 0 0 10px 0;\n        color: #666;\n        font-size: 0.8em;\n      }\n      .winner-name {\n        margin: 0;\n        padding-left: 1em;\n        font-size: 1.2em;\n        font-weight: bold;\n        color: #333;\n      }\n      input,\n      button {\n        margin: 5px;\n        padding: 5px;\n      }\n      pf-accordion {\n        margin-bottom: 20px;\n      }\n      .form-container {\n        background: #fff;\n      }\n    `,\n  ];\n\n  @state()\n  private titles: MahjongTitle[] = [];\n\n  constructor() {\n    super();\n    this._loadTitles();\n  }\n\n  private async _loadTitles() {\n    try {\n      const querySnapshot = await getDocs(collection(db, 'titles'));\n\n      const loadedTitles = querySnapshot.docs.map((doc, index) => {\n        const data = doc.data();\n        return {\n          id: index + 1,\n          year: Number(data.year),\n          name: String(data.name),\n          winner: String(data.winner),\n          displayOrder: Number(data.displayOrder),\n        } as MahjongTitle;\n      });\n\n      // データが正しく取得できているか確認\n      console.log('Loaded titles:', loadedTitles);\n\n      this.titles = loadedTitles;\n\n      // 状態が更新されたことを通知\n      this.requestUpdate();\n    } catch (e) {\n      console.error('Error loading titles: ', e);\n    }\n  }\n\n  private async addTitle(e: Event) {\n    e.preventDefault();\n    const form = e.target as HTMLFormElement;\n    const formData = new FormData(form);\n\n    const newTitle = {\n      year: Number(formData.get('year')),\n      name: String(formData.get('name')),\n      winner: String(formData.get('winner')),\n      displayOrder: Number(formData.get('displayOrder')),\n    };\n\n    try {\n      await addDoc(collection(db, 'titles'), newTitle);\n      await this._loadTitles(); // 一覧を再読み込み\n      form.reset();\n    } catch (e) {\n      console.error('Error adding title: ', e);\n    }\n  }\n\n  override render() {\n    // データがない場合のローディング表示\n    if (this.titles.length === 0) {\n      return html`\n        <div class=\"title-container\">\n          <h2>麻雀タイトル一覧</h2>\n          <p>データを読み込んでいます...</p>\n        </div>\n      `;\n    }\n\n    // 年ごとにタイトルをグループ化\n    const groupedTitles = this.titles.reduce((groups, title) => {\n      const year = title.year;\n      if (!groups[year]) {\n        groups[year] = [];\n      }\n      groups[year].push(title);\n      return groups;\n    }, {} as Record<number, MahjongTitle[]>);\n\n    // 年の降順でグループを並べ替え\n    const sortedYears = Object.keys(groupedTitles)\n      .map(Number)\n      .sort((a, b) => b - a);\n\n    return html`\n      <div class=\"title-container\">\n        <h1>麻雀タイトル一覧</h1>\n\n        <pf-accordion>\n          <pf-accordion-header>\n            <h2>タイトル登録</h2>\n          </pf-accordion-header>\n          <pf-accordion-panel>\n            <div class=\"form-container\">\n              <form class=\"title-form\" @submit=${this.addTitle}>\n                <div>\n                  <input type=\"number\" name=\"year\" placeholder=\"年\" required />\n                </div>\n                <div>\n                  <input\n                    type=\"text\"\n                    name=\"name\"\n                    placeholder=\"タイトル名\"\n                    required\n                  />\n                </div>\n                <div>\n                  <input\n                    type=\"text\"\n                    name=\"winner\"\n                    placeholder=\"タイトル獲得者名\"\n                    required\n                  />\n                </div>\n                <div>\n                  <input\n                    type=\"number\"\n                    name=\"displayOrder\"\n                    placeholder=\"表示順\"\n                    required\n                  />\n                </div>\n                <button type=\"submit\">登録</button>\n              </form>\n            </div>\n          </pf-accordion-panel>\n        </pf-accordion>\n\n        <div class=\"title-list\">\n          ${sortedYears.map(\n            (year) => html`\n              <div class=\"year-group\">\n                <div class=\"year-header\">${year}年</div>\n                <div class=\"title-items\">\n                  ${groupedTitles[year].map(\n                    (title) => html`\n                      <div class=\"title-item\">\n                        <h3>${title.name}</h3>\n                        <p class=\"winner-name\">${title.winner}</p>\n                      </div>\n                    `\n                  )}\n                </div>\n              </div>\n            `\n          )}\n        </div>\n      </div>\n    `;\n  }\n}\n"]}