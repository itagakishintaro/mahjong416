{"version":3,"file":"mahjong-calc.js","sourceRoot":"","sources":["src/mahjong-calc.ts"],"names":[],"mappings":"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","sourcesContent":["import {LitElement, html, css} from 'lit';\nimport {property, query} from 'lit/decorators.js';\nimport {customElement} from 'lit/decorators.js';\nimport '@material/web/textfield/outlined-text-field.js';\nimport '@material/web/textfield/filled-text-field.js';\nimport '@material/web/select/outlined-select.js';\nimport '@material/web/select/select-option.js';\nimport '@material/web/button/filled-tonal-button.js';\nimport '@material/web/button/filled-button.js';\nimport '@material/web/progress/circular-progress.js';\nimport '@patternfly/elements/pf-accordion/pf-accordion.js';\nimport {db} from './firestore';\nimport {collection, addDoc} from 'firebase/firestore/lite';\nimport './mahjong-calc-chonbo.js';\nimport './mahjong-calc-yakuman.js';\nimport './mahjong-calc-date-and-key.js';\n\n@customElement('mahjong-calc')\nexport class MahjongCalc extends LitElement {\n  static override styles = [\n    css`\n      .width-50 {\n        width: calc(50% - 1rem);\n        margin-bottom: 0.5em;\n      }\n      .width-30 {\n        width: 30%;\n        margin-bottom: 0.5em;\n      }\n      .results {\n        margin-top: 2em;\n        margin-left: 1em;\n      }\n      .controle {\n        margin-top: 1em;\n      }\n      md-outlined-text-field {\n        --md-outlined-field-disabled-content-opacity: 1;\n      }\n    `,\n  ];\n\n  override render() {\n    return html`\n      <h1>点数計算</h1>\n\n      <md-outlined-select required id=\"gameType\" @change=\"${this._changeGame}\">\n        <md-select-option selected value=\"四麻\">\n          <div slot=\"headline\">四麻</div>\n        </md-select-option>\n        <md-select-option value=\"三麻\">\n          <div slot=\"headline\">三麻</div>\n        </md-select-option>\n      </md-outlined-select>\n\n      <pf-accordion>\n        <pf-accordion-header>\n          <h2>設定</h2>\n        </pf-accordion-header>\n        <pf-accordion-panel>\n          <div>\n            <md-outlined-text-field\n              id=\"initialPoint\"\n              class=\"width-50\"\n              label=\"初期点\"\n              type=\"number\"\n              value=\"25000\"\n              required\n            ></md-outlined-text-field>\n            <md-outlined-text-field\n              id=\"oka\"\n              class=\"width-50\"\n              label=\"オカ\"\n              type=\"number\"\n              value=\"30000\"\n              required\n            ></md-outlined-text-field>\n          </div>\n          <div>\n            <md-outlined-text-field\n              id=\"firstUma\"\n              class=\"width-50\"\n              label=\"1着\"\n              type=\"number\"\n              value=\"50\"\n              required\n            ></md-outlined-text-field>\n            <md-outlined-text-field\n              id=\"secondUma\"\n              class=\"width-50\"\n              label=\"2着\"\n              type=\"number\"\n              value=\"10\"\n              required\n            ></md-outlined-text-field>\n            <md-outlined-text-field\n              id=\"thirdUma\"\n              class=\"width-50\"\n              label=\"3着\"\n              type=\"number\"\n              value=\"-10\"\n              required\n            ></md-outlined-text-field>\n            <md-outlined-text-field\n              id=\"fourthUma\"\n              class=\"width-50\"\n              label=\"4着\"\n              type=\"number\"\n              value=\"-30\"\n              required\n            ></md-outlined-text-field>\n          </div>\n        </pf-accordion-panel>\n      </pf-accordion>\n      <div class=\"results\">\n        <h2>結果</h2>\n\n        <!-- 日付、順序キー -->\n        <mahjong-calc-date-and-key></mahjong-calc-date-and-key>\n        <!-- チョンボ -->\n        <mahjong-calc-chonbo></mahjong-calc-chonbo>\n        <!-- 役満 -->\n        <mahjong-calc-yakuman></mahjong-calc-yakuman>\n        <div>\n          <md-outlined-text-field\n            id=\"firstPlayer\"\n            label=\"1位\"\n            class=\"width-30\"\n            type=\"text\"\n            value=\"\"\n          >\n          </md-outlined-text-field>\n          <md-outlined-text-field\n            id=\"firstScore\"\n            label=\"得点\"\n            class=\"width-30\"\n            type=\"number\"\n            value=\"\"\n            @blur=\"${this._calcPoint}\"\n          >\n          </md-outlined-text-field>\n          <span>→</span>\n          <md-outlined-text-field\n            id=\"firstPoint\"\n            label=\"ポイント\"\n            class=\"width-30\"\n            type=\"number\"\n            step=\"0.1\"\n            value=\"\"\n            disabled\n          >\n          </md-outlined-text-field>\n        </div>\n        <div>\n          <md-outlined-text-field\n            id=\"secondPlayer\"\n            label=\"2位\"\n            class=\"width-30\"\n            type=\"text\"\n            value=\"\"\n          >\n          </md-outlined-text-field>\n          <md-outlined-text-field\n            id=\"secondScore\"\n            label=\"得点\"\n            class=\"width-30\"\n            type=\"number\"\n            value=\"\"\n            @blur=\"${this._calcPoint}\"\n          >\n          </md-outlined-text-field>\n          <span>→</span>\n          <md-outlined-text-field\n            id=\"secondPoint\"\n            label=\"ポイント\"\n            class=\"width-30\"\n            type=\"number\"\n            step=\"0.1\"\n            value=\"\"\n            disabled\n          >\n          </md-outlined-text-field>\n        </div>\n        <div>\n          <md-outlined-text-field\n            id=\"thirdPlayer\"\n            label=\"3位\"\n            class=\"width-30\"\n            type=\"text\"\n            value=\"\"\n          >\n          </md-outlined-text-field>\n          <md-outlined-text-field\n            id=\"thirdScore\"\n            label=\"得点\"\n            class=\"width-30\"\n            type=\"number\"\n            value=\"\"\n            @blur=\"${this._calcPoint}\"\n          >\n          </md-outlined-text-field>\n          <span>→</span>\n          <md-outlined-text-field\n            id=\"thirdPoint\"\n            label=\"ポイント\"\n            class=\"width-30\"\n            type=\"number\"\n            step=\"0.1\"\n            value=\"\"\n            disabled\n          >\n          </md-outlined-text-field>\n        </div>\n        <div>\n          <md-outlined-text-field\n            id=\"fourthPlayer\"\n            label=\"4位\"\n            class=\"width-30\"\n            type=\"text\"\n            value=\"\"\n          >\n          </md-outlined-text-field>\n          <md-outlined-text-field\n            id=\"fourthScore\"\n            label=\"得点\"\n            class=\"width-30\"\n            type=\"number\"\n            value=\"\"\n            @blur=\"${this._calcPoint}\"\n          >\n          </md-outlined-text-field>\n          <span>→</span>\n          <md-outlined-text-field\n            id=\"fourthPoint\"\n            label=\"ポイント\"\n            class=\"width-30\"\n            type=\"number\"\n            step=\"0.1\"\n            value=\"\"\n            disabled\n          >\n          </md-outlined-text-field>\n        </div>\n\n        <div class=\"controle\">\n          <md-filled-tonal-button @click=\"${this._resetResults}\"\n            >リセット</md-filled-tonal-button\n          >\n          <md-filled-button\n            @click=\"${this._uploadResults}\"\n            ?disabled=\"${this.isPointCheckError}\"\n            >登録</md-filled-button\n          >\n          <md-circular-progress\n            indeterminate\n            id=\"progress\"\n            style=\"display: none\"\n          ></md-circular-progress>\n        </div>\n      </div>\n    `;\n  }\n\n  @property({type: Boolean})\n  isPointCheckError = true;\n\n  @query('#gameType')\n  gameTypeElement!: HTMLSelectElement;\n\n  @query('#initialPoint')\n  initialPointElement!: HTMLInputElement;\n  @query('#oka')\n  okaElement!: HTMLInputElement;\n  @query('#firstUma')\n  firstUmaElement!: HTMLInputElement;\n  @query('#secondUma')\n  secondUmaElement!: HTMLInputElement;\n  @query('#thirdUma')\n  thirdUmaElement!: HTMLInputElement;\n  @query('#fourthUma')\n  fourthUmaElement!: HTMLInputElement;\n\n  @query('#firstPlayer')\n  firstPlayerElement!: HTMLInputElement;\n  @query('#secondPlayer')\n  secondPlayerElement!: HTMLInputElement;\n  @query('#thirdPlayer')\n  thirdPlayerElement!: HTMLInputElement;\n  @query('#fourthPlayer')\n  fourthPlayerElement!: HTMLInputElement;\n\n  @query('#firstScore')\n  firstScoreElement!: HTMLInputElement;\n  @query('#secondScore')\n  secondScoreElement!: HTMLInputElement;\n  @query('#thirdScore')\n  thirdScoreElement!: HTMLInputElement;\n  @query('#fourthScore')\n  fourthScoreElement!: HTMLInputElement;\n\n  @query('#firstPoint')\n  firstPointElement!: HTMLInputElement;\n  @query('#secondPoint')\n  secondPointElement!: HTMLInputElement;\n  @query('#thirdPoint')\n  thirdPointElement!: HTMLInputElement;\n  @query('#fourthPoint')\n  fourthPointElement!: HTMLInputElement;\n\n  @query('#progress')\n  progressElement!: HTMLElement;\n\n  private _calcPoint() {\n    if (this.gameTypeElement.value === '三麻') {\n      this._calc3maPoint();\n    } else {\n      this._calc4maPoint();\n    }\n    this._setIsPointCheckError();\n  }\n\n  // Calculate points for 4-player Mahjong\n  private _calc4maPoint() {\n    const firstScore = this.firstScoreElement.valueAsNumber;\n    const secondScore = this.secondScoreElement.valueAsNumber;\n    const thirdScore = this.thirdScoreElement.valueAsNumber;\n    const fourthScore = this.fourthScoreElement.valueAsNumber;\n    const firstUma = this.firstUmaElement.valueAsNumber;\n    const secondUma = this.secondUmaElement.valueAsNumber;\n    const thirdUma = this.thirdUmaElement.valueAsNumber;\n    const fourthUma = this.fourthUmaElement.valueAsNumber;\n    const oka = this.okaElement.valueAsNumber;\n    // Helper function to set points\n    const setPoints = (\n      first: number,\n      second: number,\n      third: number,\n      fourth: number\n    ) => {\n      if (firstScore) {\n        this.firstPointElement.value = String(first);\n      }\n      if (secondScore) {\n        this.secondPointElement.value = String(second);\n      }\n      if (thirdScore) {\n        this.thirdPointElement.value = String(third);\n      }\n      if (fourthScore) {\n        this.fourthPointElement.value = String(fourth);\n      }\n    };\n\n    // All players have the same score\n    if (\n      firstScore === secondScore &&\n      firstScore === thirdScore &&\n      firstScore === fourthScore\n    ) {\n      const umaSum = firstUma + secondUma + thirdUma + fourthUma;\n      const point = (firstScore - oka) / 1000 + umaSum / 4;\n      setPoints(point, point, point, point);\n    }\n    // First, second, and third players have the same score\n    else if (firstScore === secondScore && firstScore === thirdScore) {\n      const umaSum = firstUma + secondUma + thirdUma;\n      const firstPoint = (firstScore - oka) / 1000 + umaSum / 3;\n      const fourthPoint = (fourthScore - oka) / 1000 + fourthUma;\n      setPoints(firstPoint, firstPoint, firstPoint, fourthPoint);\n    }\n    // Second, third, and fourth players have the same score\n    else if (secondScore === thirdScore && secondScore === fourthScore) {\n      const umaSum = secondUma + thirdUma + fourthUma;\n      const secondPoint = (secondScore - oka) / 1000 + umaSum / 3;\n      const firstPoint = (firstScore - oka) / 1000 + firstUma;\n      setPoints(firstPoint, secondPoint, secondPoint, secondPoint);\n    }\n    // First and second players have the same score\n    else if (firstScore === secondScore) {\n      const umaSum = firstUma + secondUma;\n      const firstPoint = (firstScore - oka) / 1000 + umaSum / 2;\n      const thirdPoint = (thirdScore - oka) / 1000 + thirdUma;\n      const fourthPoint = (fourthScore - oka) / 1000 + fourthUma;\n      setPoints(firstPoint, firstPoint, thirdPoint, fourthPoint);\n    }\n    // Second and third players have the same score\n    else if (secondScore === thirdScore) {\n      const umaSum = secondUma + thirdUma;\n      const secondPoint = (secondScore - oka) / 1000 + umaSum / 2;\n      const firstPoint = (firstScore - oka) / 1000 + firstUma;\n      const fourthPoint = (fourthScore - oka) / 1000 + fourthUma;\n      setPoints(firstPoint, secondPoint, secondPoint, fourthPoint);\n    }\n    // Third and fourth players have the same score\n    else if (thirdScore === fourthScore) {\n      const umaSum = thirdUma + fourthUma;\n      const thirdPoint = (thirdScore - oka) / 1000 + umaSum / 2;\n      const firstPoint = (firstScore - oka) / 1000 + firstUma;\n      const secondPoint = (secondScore - oka) / 1000 + secondUma;\n      setPoints(firstPoint, secondPoint, thirdPoint, thirdPoint);\n    }\n    // Normal calculation\n    else {\n      const firstPoint = (firstScore - oka) / 1000 + firstUma;\n      const secondPoint = (secondScore - oka) / 1000 + secondUma;\n      const thirdPoint = (thirdScore - oka) / 1000 + thirdUma;\n      const fourthPoint = (fourthScore - oka) / 1000 + fourthUma;\n      setPoints(firstPoint, secondPoint, thirdPoint, fourthPoint);\n    }\n  }\n\n  // Calculate points for 3-player Mahjong\n  private _calc3maPoint() {\n    const firstScore = this.firstScoreElement.valueAsNumber;\n    const secondScore = this.secondScoreElement.valueAsNumber;\n    const thirdScore = this.thirdScoreElement.valueAsNumber;\n    const firstUma = this.firstUmaElement.valueAsNumber;\n    const secondUma = this.secondUmaElement.valueAsNumber;\n    const thirdUma = this.thirdUmaElement.valueAsNumber;\n    const oka = this.okaElement.valueAsNumber;\n\n    // Helper function to set points\n    const setPoints = (first: number, second: number, third: number) => {\n      this.firstPointElement.value = String(first);\n      this.secondPointElement.value = String(second);\n      this.thirdPointElement.value = String(third);\n    };\n\n    // All players have the same score\n    if (firstScore === secondScore && firstScore === thirdScore) {\n      const umaSum = firstUma + secondUma + thirdUma;\n      const point = (firstScore - oka) / 1000 + umaSum / 3;\n      setPoints(point, point, point);\n    }\n    // First and second players have the same score\n    else if (firstScore === secondScore) {\n      const umaSum = firstUma + secondUma;\n      const firstPoint = (firstScore - oka) / 1000 + umaSum / 2;\n      const thirdPoint = (thirdScore - oka) / 1000 + thirdUma;\n      setPoints(firstPoint, firstPoint, thirdPoint);\n    }\n    // Second and third players have the same score\n    else if (secondScore === thirdScore) {\n      const umaSum = secondUma + thirdUma;\n      const secondPoint = (secondScore - oka) / 1000 + umaSum / 2;\n      const firstPoint = (firstScore - oka) / 1000 + firstUma;\n      setPoints(firstPoint, secondPoint, secondPoint);\n    }\n    // Normal calculation\n    else {\n      const firstPoint = (firstScore - oka) / 1000 + firstUma;\n      const secondPoint = (secondScore - oka) / 1000 + secondUma;\n      const thirdPoint = (thirdScore - oka) / 1000 + thirdUma;\n      setPoints(firstPoint, secondPoint, thirdPoint);\n    }\n  }\n\n  private _changeGame() {\n    if (this.gameTypeElement.value === '三麻') {\n      this._changeSettings(35000, 35000, 15, 0, -15, 0, true);\n    } else {\n      this._changeSettings(25000, 30000, 50, 10, -10, -30, false);\n    }\n    this._resetResults();\n  }\n\n  private _setIsPointCheckError() {\n    const isSanma = this.gameTypeElement?.value === '三麻';\n    const scores = [\n      this.firstScoreElement.valueAsNumber,\n      this.secondScoreElement.valueAsNumber,\n      this.thirdScoreElement.valueAsNumber,\n    ];\n\n    if (!isSanma) {\n      scores.push(this.fourthScoreElement.valueAsNumber);\n    }\n\n    const totalScore = scores.reduce((acc, score) => acc + score, 0);\n    const expectedTotal =\n      this.initialPointElement.valueAsNumber * (isSanma ? 3 : 4);\n\n    this.isPointCheckError = !(\n      this.initialPointElement.valueAsNumber && totalScore === expectedTotal\n    );\n  }\n\n  private _changeSettings(\n    initialPoint: number,\n    oka: number,\n    firstUma: number,\n    secondUma: number,\n    thirdUma: number,\n    fourthUma: number,\n    noFourth: boolean\n  ) {\n    this.initialPointElement.value = String(initialPoint);\n    this.okaElement.value = String(oka);\n    this.firstUmaElement.value = String(firstUma);\n    this.secondUmaElement.value = String(secondUma);\n    this.thirdUmaElement.value = String(thirdUma);\n    this.fourthUmaElement.value = String(fourthUma);\n    if (!noFourth) {\n      this._clearFourth();\n    }\n    this._toggleFourth(noFourth);\n  }\n\n  private _clearFourth() {\n    this.fourthPlayerElement.value = '';\n    this.fourthScoreElement.value = '';\n    this.fourthPointElement.value = '';\n  }\n\n  private _toggleFourth(noFourth: boolean) {\n    this.fourthUmaElement.disabled = noFourth;\n    this.fourthPlayerElement.disabled = noFourth;\n    this.fourthScoreElement.disabled = noFourth;\n  }\n\n  private _resetResults() {\n    this.firstPlayerElement.value = '';\n    this.secondPlayerElement.value = '';\n    this.thirdPlayerElement.value = '';\n    this.fourthPlayerElement.value = '';\n    this.firstScoreElement.value = '';\n    this.secondScoreElement.value = '';\n    this.thirdScoreElement.value = '';\n    this.fourthScoreElement.value = '';\n    this.firstPointElement.value = '';\n    this.secondPointElement.value = '';\n    this.thirdPointElement.value = '';\n    this.fourthPointElement.value = '';\n  }\n\n  private async _uploadResults() {\n    this.progressElement.style.display = 'block';\n    let players: string[];\n    let results: Result[];\n    const chonbo: Chonbo[] = [];\n    const yakuman: Yakuman[] = [];\n    if (this.gameTypeElement.value === '四麻') {\n      players = [\n        this.firstPlayerElement.value,\n        this.secondPlayerElement.value,\n        this.thirdPlayerElement.value,\n        this.fourthPlayerElement.value,\n      ].sort();\n      results = [\n        {\n          rank: 1,\n          player: this.firstPlayerElement.value,\n          score: Number(this.firstScoreElement.value),\n          point: Number(this.firstPointElement.value),\n        },\n        {\n          rank:\n            this.firstScoreElement.value === this.secondScoreElement.value\n              ? 1\n              : 2,\n          player: this.secondPlayerElement.value,\n          score: Number(this.secondScoreElement.value),\n          point: Number(this.secondPointElement.value),\n        },\n        {\n          rank:\n            this.firstScoreElement.value === this.thirdScoreElement.value\n              ? 1\n              : this.secondScoreElement.value === this.thirdScoreElement.value\n              ? 2\n              : 3,\n          player: this.thirdPlayerElement.value,\n          score: Number(this.thirdScoreElement.value),\n          point: Number(this.thirdPointElement.value),\n        },\n        {\n          rank:\n            this.firstScoreElement.value === this.fourthScoreElement.value\n              ? 1\n              : this.secondScoreElement.value === this.fourthScoreElement.value\n              ? 2\n              : this.thirdScoreElement.value === this.fourthScoreElement.value\n              ? 3\n              : 4,\n          player: this.fourthPlayerElement.value,\n          score: Number(this.fourthScoreElement.value),\n          point: Number(this.fourthPointElement.value),\n        },\n      ];\n    } else {\n      players = [\n        this.firstPlayerElement.value,\n        this.secondPlayerElement.value,\n        this.thirdPlayerElement.value,\n      ].sort();\n      results = [\n        {\n          rank: 1,\n          player: this.firstPlayerElement.value,\n          score: Number(this.firstScoreElement.value),\n          point: Number(this.firstPointElement.value),\n        },\n        {\n          rank: 2,\n          player: this.secondPlayerElement.value,\n          score: Number(this.secondScoreElement.value),\n          point: Number(this.secondPointElement.value),\n        },\n        {\n          rank: 3,\n          player: this.thirdPlayerElement.value,\n          score: Number(this.thirdScoreElement.value),\n          point: Number(this.thirdPointElement.value),\n        },\n      ];\n    }\n\n    // チョンボ\n    const chonboElement = this.renderRoot?.querySelector(\n      'mahjong-calc-chonbo'\n    ) as LitElement;\n    const chonboPlayer1 = chonboElement?.renderRoot.querySelector(\n      '#chonboPlayer1'\n    ) as HTMLInputElement;\n    const chonboPoint1 = chonboElement?.renderRoot.querySelector(\n      '#chonboPoint1'\n    ) as HTMLInputElement;\n    if (chonboPlayer1.value !== '') {\n      chonbo.push({\n        player: chonboPlayer1.value,\n        point: Number(chonboPoint1.value),\n      });\n    }\n    const chonboPlayer2 = chonboElement?.renderRoot.querySelector(\n      '#chonboPlayer2'\n    ) as HTMLInputElement;\n    const chonboPoint2 = chonboElement?.renderRoot.querySelector(\n      '#chonboPoint2'\n    ) as HTMLInputElement;\n    if (chonboPlayer2.value !== '') {\n      chonbo.push({\n        player: chonboPlayer2.value,\n        point: Number(chonboPoint2.value),\n      });\n    }\n    const chonboPlayer3 = chonboElement?.renderRoot.querySelector(\n      '#chonboPlayer3'\n    ) as HTMLInputElement;\n    const chonboPoint3 = chonboElement?.renderRoot.querySelector(\n      '#chonboPoint3'\n    ) as HTMLInputElement;\n    if (chonboPlayer3.value !== '') {\n      chonbo.push({\n        player: chonboPlayer3.value,\n        point: Number(chonboPoint3.value),\n      });\n    }\n    const chonboPlayer4 = chonboElement?.renderRoot.querySelector(\n      '#chonboPlayer4'\n    ) as HTMLInputElement;\n    const chonboPoint4 = chonboElement?.renderRoot.querySelector(\n      '#chonboPoint4'\n    ) as HTMLInputElement;\n    if (chonboPlayer4.value !== '') {\n      chonbo.push({\n        player: chonboPlayer4.value,\n        point: Number(chonboPoint4.value),\n      });\n    }\n\n    // 役満\n    const yakumanElement = this.renderRoot?.querySelector(\n      'mahjong-calc-yakuman'\n    ) as LitElement;\n    const yakumanPlayer1 = yakumanElement?.renderRoot.querySelector(\n      '#yakumanPlayer1'\n    ) as HTMLInputElement;\n    const yakuman1 = yakumanElement?.renderRoot.querySelector(\n      '#yakuman1'\n    ) as HTMLInputElement;\n    if (yakumanPlayer1.value !== '') {\n      yakuman.push({\n        player: yakumanPlayer1.value,\n        yakuman: yakuman1.value,\n      });\n    }\n    const yakumanPlayer2 = yakumanElement?.renderRoot.querySelector(\n      '#yakumanPlayer2'\n    ) as HTMLInputElement;\n    const yakuman2 = yakumanElement?.renderRoot.querySelector(\n      '#yakuman2'\n    ) as HTMLInputElement;\n    if (yakumanPlayer2.value !== '') {\n      yakuman.push({\n        player: yakumanPlayer2.value,\n        yakuman: yakuman2.value,\n      });\n    }\n    const yakumanPlayer3 = yakumanElement?.renderRoot.querySelector(\n      '#yakumanPlayer3'\n    ) as HTMLInputElement;\n    const yakuman3 = yakumanElement?.renderRoot.querySelector(\n      '#yakuman3'\n    ) as HTMLInputElement;\n    if (yakumanPlayer3.value !== '') {\n      yakuman.push({\n        player: yakumanPlayer3.value,\n        yakuman: yakuman3.value,\n      });\n    }\n    const yakumanPlayer4 = yakumanElement?.renderRoot.querySelector(\n      '#yakumanPlayer4'\n    ) as HTMLInputElement;\n    const yakuman4 = yakumanElement?.renderRoot.querySelector(\n      '#yakuman4'\n    ) as HTMLInputElement;\n    if (yakumanPlayer4.value !== '') {\n      yakuman.push({\n        player: yakumanPlayer4.value,\n        yakuman: yakuman4.value,\n      });\n    }\n\n    // 日付、順序キー\n    const dateAndKeyElement = this.renderRoot?.querySelector(\n      'mahjong-calc-date-and-key'\n    ) as LitElement;\n    const dateElement = dateAndKeyElement?.renderRoot?.querySelector(\n      '#date'\n    ) as HTMLInputElement;\n    const orderElement = dateAndKeyElement?.renderRoot?.querySelector(\n      '#order'\n    ) as HTMLInputElement;\n\n    const data = {\n      gameInfo: {\n        date: dateElement?.value,\n        order: orderElement?.value,\n        gameType: this.gameTypeElement.value,\n        players: players,\n      },\n      results: results,\n      chonbo: chonbo,\n      yakuman: yakuman,\n    };\n    try {\n      const docRef = await addDoc(collection(db, 'results'), data);\n      console.log('Document written with ID: ', docRef.id);\n      this.dispatchEvent(\n        new CustomEvent('uploaded', {bubbles: true, composed: true})\n      );\n    } catch (e) {\n      console.error('Error adding document: ', e);\n    } finally {\n      this.progressElement.style.display = 'none';\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'mahjong-calc': MahjongCalc;\n  }\n}\n"]}